import{S as ne,i as le,s as se,e as w,c as y,b as L,d as g,g as _,j as I,n as G,l as me,F as je,a as A,t as Me,f as R,p as Be,G as j,k as E,m as z,H as qe,I as We,J as ve,K as be,L as we,M as ye,u as O,y as ke,w as U,v as Ee,o as Ge,N as He,O as ie,E as F,P as re,Q as J,z as Q,D as H,A as Y,B as X,R as Z,C as $,r as Ce,T as Ke,h as N}from"./index.a18ea272.js";import{e as x}from"./each.3d878967.js";const Je="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let Qe=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)e+=Je[n[t]&63];return e};function oe(t,e,n){const a=t.slice();return a[5]=e[n],a}function ue(t){let e,n,a,i=!1,l,s,u=t[5].label+"",r,o,p,f,d;return p=je(t[4][0]),{c(){e=w("label"),n=w("input"),l=A(),s=w("span"),r=Me(u),o=A(),this.h()},l(h){e=y(h,"LABEL",{class:!0});var c=L(e);n=y(c,"INPUT",{type:!0,name:!0,class:!0}),l=R(c),s=y(c,"SPAN",{class:!0});var m=L(s);r=Be(m,u),m.forEach(g),o=R(c),c.forEach(g),this.h()},h(){_(n,"type","radio"),_(n,"name",t[2]),n.__value=a=t[5].value,j(n,n.__value),_(n,"class","svelte-939ti0"),_(s,"class","button svelte-939ti0"),_(e,"class","wrapper svelte-939ti0"),p.p(n)},m(h,c){I(h,e,c),E(e,n),n.checked=n.__value===t[0],E(e,l),E(e,s),E(s,r),E(e,o),f||(d=z(n,"change",t[3]),f=!0)},p(h,c){c&2&&a!==(a=h[5].value)&&(n.__value=a,j(n,n.__value),i=!0),(i||c&3)&&(n.checked=n.__value===h[0]),c&2&&u!==(u=h[5].label+"")&&qe(r,u)},d(h){h&&g(e),p.r(),f=!1,d()}}}function Ye(t){let e,n=x(t[1]),a=[];for(let i=0;i<n.length;i+=1)a[i]=ue(oe(t,n,i));return{c(){e=w("div");for(let i=0;i<a.length;i+=1)a[i].c();this.h()},l(i){e=y(i,"DIV",{class:!0});var l=L(e);for(let s=0;s<a.length;s+=1)a[s].l(l);l.forEach(g),this.h()},h(){_(e,"class","group svelte-939ti0")},m(i,l){I(i,e,l);for(let s=0;s<a.length;s+=1)a[s]&&a[s].m(e,null)},p(i,[l]){if(l&7){n=x(i[1]);let s;for(s=0;s<n.length;s+=1){const u=oe(i,n,s);a[s]?a[s].p(u,l):(a[s]=ue(u),a[s].c(),a[s].m(e,null))}for(;s<a.length;s+=1)a[s].d(1);a.length=n.length}},i:G,o:G,d(i){i&&g(e),me(a,i)}}}function Xe(t,e,n){const a=Qe();let{options:i=[]}=e,{value:l}=e;const s=[[]];function u(){l=this.__value,n(0,l)}return t.$$set=r=>{"options"in r&&n(1,i=r.options),"value"in r&&n(0,l=r.value)},[l,i,a,u,s]}class te extends ne{constructor(e){super(),le(this,e,Xe,Ye,se,{options:1,value:0})}}function ce(t,{delay:e=0,duration:n=400,easing:a=We}={}){const i=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:a,css:l=>`opacity: ${l*i}`}}const Ze=t=>({}),fe=t=>({});function pe(t){let e,n,a;const i=t[5].default,l=ve(i,t,t[4],null);return{c(){e=w("nav"),l&&l.c(),this.h()},l(s){e=y(s,"NAV",{class:!0,"aria-label":!0});var u=L(e);l&&l.l(u),u.forEach(g),this.h()},h(){_(e,"class","menu svelte-v9qt9l"),_(e,"aria-label",t[1])},m(s,u){I(s,e,u),l&&l.m(e,null),a=!0},p(s,u){l&&l.p&&(!a||u&16)&&be(l,i,s,s[4],a?ye(i,s[4],u,null):we(s[4]),null),(!a||u&2)&&_(e,"aria-label",s[1])},i(s){a||(O(l,s),s&&He(()=>{a&&(n||(n=ie(e,ce,{duration:100},!0)),n.run(1))}),a=!0)},o(s){U(l,s),s&&(n||(n=ie(e,ce,{duration:100},!1)),n.run(0)),a=!1},d(s){s&&g(e),l&&l.d(s),s&&n&&n.end()}}}function $e(t){let e,n,a,i,l,s;const u=t[5].trigger,r=ve(u,t,t[4],fe);let o=t[0]&&pe(t);return{c(){e=w("details"),n=w("summary"),r&&r.c(),a=A(),o&&o.c(),this.h()},l(p){e=y(p,"DETAILS",{class:!0});var f=L(e);n=y(f,"SUMMARY",{class:!0});var d=L(n);r&&r.l(d),d.forEach(g),a=R(f),o&&o.l(f),f.forEach(g),this.h()},h(){_(n,"class","summary svelte-v9qt9l"),_(e,"class","dropdown svelte-v9qt9l")},m(p,f){I(p,e,f),E(e,n),r&&r.m(n,null),E(e,a),o&&o.m(e,null),t[6](e),i=!0,l||(s=z(e,"toggle",t[3]),l=!0)},p(p,[f]){r&&r.p&&(!i||f&16)&&be(r,u,p,p[4],i?ye(u,p[4],f,Ze):we(p[4]),fe),p[0]?o?(o.p(p,f),f&1&&O(o,1)):(o=pe(p),o.c(),O(o,1),o.m(e,null)):o&&(ke(),U(o,1,1,()=>{o=null}),Ee())},i(p){i||(O(r,p),O(o),i=!0)},o(p){U(r,p),U(o),i=!1},d(p){p&&g(e),r&&r.d(p),o&&o.d(),t[6](null),l=!1,s()}}}function xe(t,e,n){let{$$slots:a={},$$scope:i}=e,{isOpen:l=!1}=e,{label:s="Меню"}=e,u;function r(f){n(0,l=f.target.open)}function o(f){f.key==="Escape"&&l&&(n(0,l=!1),u?.querySelector("summary")?.focus())}Ge(()=>(document.addEventListener("keydown",o),()=>document.removeEventListener("keydown",o)));function p(f){F[f?"unshift":"push"](()=>{u=f,n(2,u),n(0,l)})}return t.$$set=f=>{"isOpen"in f&&n(0,l=f.isOpen),"label"in f&&n(1,s=f.label),"$$scope"in f&&n(4,i=f.$$scope)},t.$$.update=()=>{t.$$.dirty&5&&u&&n(2,u.open=l,u)},[l,s,u,r,i,a,p]}class et extends ne{constructor(e){super(),le(this,e,xe,$e,se,{isOpen:0,label:1})}}const W=document.createElement("a");document.body.appendChild(W);W.style.display="none";function tt(t,e){return new Promise(n=>{t.toBlob(a=>{if(a){const i=URL.createObjectURL(a);W.href=i,W.download=`${e}.jpg`,W.click(),URL.revokeObjectURL(i),n(a)}},"image/jpeg")})}const nt={s:1e3,m:2e3,l:3e3};function Se(t){return nt[t]}function lt(t,e){return Se(e)*(t/100)}function Ie(t,{size:e,spacing:n},a){const l={items:[],w:0,h:0},s=t.map(d=>d.width/d.height),u=Se(e),r=lt(n,e),o=s.map(d=>a?[u,Math.round(u/d)]:[Math.round(u*d),u]),p=o.map(([d,h])=>a?h:d).reduce((d,h)=>d+h,r*(t.length+1));a?(l.w=u+r*2,l.h=p):(l.w=p,l.h=u+r*2);let f=r;return t.forEach((d,h)=>{const c=o[h];a?(l.items.push({image:d,x:r,y:f,w:c[0],h:c[1]}),f+=c[1]+r):(l.items.push({image:d,x:f,y:r,w:c[0],h:c[1]}),f+=c[0]+r)}),l}function st(t,e){return Ie(t,e,!0)}function at(t,e){return Ie(t,e,!1)}const it={horizontal:at,vertical:st};async function rt(t){return Promise.all(t.map(e=>new Promise(n=>{const a=new Image;a.onload=()=>{n(a)},a.src=e})))}function he(t,e,n){const a=t.slice();return a[31]=e[n],a[33]=n,a}function de(t){let e,n,a,i="+",l,s,u,r,o,p,f,d,h,c,m;function D(k){t[20](k)}let T={options:[{value:"horizontal",label:"Horizontal"},{value:"vertical",label:"Vertical"}]};t[2]!==void 0&&(T.value=t[2]),r=new te({props:T}),F.push(()=>J(r,"value",D));function v(k){t[25](k)}let C={$$slots:{trigger:[ut],default:[ot]},$$scope:{ctx:t}};return t[9]!==void 0&&(C.isOpen=t[9]),f=new et({props:C}),F.push(()=>J(f,"isOpen",v)),{c(){e=w("div"),n=w("label"),a=w("div"),a.textContent=i,l=A(),s=w("input"),u=A(),Q(r.$$.fragment),p=A(),Q(f.$$.fragment),this.h()},l(k){e=y(k,"DIV",{class:!0});var S=L(e);n=y(S,"LABEL",{class:!0});var V=L(n);a=y(V,"DIV",{class:!0,["data-svelte-h"]:!0}),H(a)!=="svelte-evoge6"&&(a.textContent=i),l=R(V),s=y(V,"INPUT",{type:!0,accept:!0,class:!0}),V.forEach(g),u=R(S),Y(r.$$.fragment,S),p=R(S),Y(f.$$.fragment,S),S.forEach(g),this.h()},h(){_(a,"class","button svelte-a6ns41"),_(s,"type","file"),s.multiple=!0,_(s,"accept","image/png, image/jpeg"),_(s,"class","svelte-a6ns41"),_(n,"class","input svelte-a6ns41"),_(e,"class","panel svelte-a6ns41")},m(k,S){I(k,e,S),E(e,n),E(n,a),E(n,l),E(n,s),E(e,u),X(r,e,null),E(e,p),X(f,e,null),h=!0,c||(m=z(s,"change",t[14]),c=!0)},p(k,S){const V={};!o&&S[0]&4&&(o=!0,V.value=k[2],Z(()=>o=!1)),r.$set(V);const M={};S[0]&58|S[1]&8&&(M.$$scope={dirty:S,ctx:k}),!d&&S[0]&512&&(d=!0,M.isOpen=k[9],Z(()=>d=!1)),f.$set(M)},i(k){h||(O(r.$$.fragment,k),O(f.$$.fragment,k),h=!0)},o(k){U(r.$$.fragment,k),U(f.$$.fragment,k),h=!1},d(k){k&&g(e),$(r),$(f),c=!1,m()}}}function ot(t){let e,n,a,i,l,s,u,r,o,p,f,d,h;function c(v){t[21](v)}let m={options:[{value:"s",label:"S"},{value:"m",label:"M"},{value:"l",label:"L"}]};t[3]!==void 0&&(m.value=t[3]),n=new te({props:m}),F.push(()=>J(n,"value",c));function D(v){t[22](v)}let T={options:[{value:"auto",label:"Auto"},{value:(1/1).toString(),label:"1/1"},{value:(4/5).toString(),label:"4/5"},{value:(5/4).toString(),label:"5/4"},{value:(9/16).toString(),label:"9/16"}]};return t[5]!==void 0&&(T.value=t[5]),l=new te({props:T}),F.push(()=>J(l,"value",D)),{c(){e=w("div"),Q(n.$$.fragment),i=A(),Q(l.$$.fragment),u=A(),r=w("input"),o=A(),p=w("input"),this.h()},l(v){e=y(v,"DIV",{class:!0});var C=L(e);Y(n.$$.fragment,C),i=R(C),Y(l.$$.fragment,C),u=R(C),r=y(C,"INPUT",{type:!0}),o=R(C),p=y(C,"INPUT",{type:!0,class:!0,min:!0,max:!0,step:!0}),C.forEach(g),this.h()},h(){_(r,"type","color"),_(p,"type","range"),_(p,"class","spacingInput svelte-a6ns41"),_(p,"min","0"),_(p,"max","10"),_(p,"step","1"),_(e,"class","settingsMenu svelte-a6ns41")},m(v,C){I(v,e,C),X(n,e,null),E(e,i),X(l,e,null),E(e,u),E(e,r),j(r,t[1]),E(e,o),E(e,p),j(p,t[4]),f=!0,d||(h=[z(r,"input",t[23]),z(p,"change",t[24]),z(p,"input",t[24])],d=!0)},p(v,C){const k={};!a&&C[0]&8&&(a=!0,k.value=v[3],Z(()=>a=!1)),n.$set(k);const S={};!s&&C[0]&32&&(s=!0,S.value=v[5],Z(()=>s=!1)),l.$set(S),C[0]&2&&j(r,v[1]),C[0]&16&&j(p,v[4])},i(v){f||(O(n.$$.fragment,v),O(l.$$.fragment,v),f=!0)},o(v){U(n.$$.fragment,v),U(l.$$.fragment,v),f=!1},d(v){v&&g(e),$(n),$(l),d=!1,Ce(h)}}}function ut(t){let e,n="Settings";return{c(){e=w("div"),e.textContent=n,this.h()},l(a){e=y(a,"DIV",{class:!0,slot:!0,["data-svelte-h"]:!0}),H(e)!=="svelte-jbxl7d"&&(e.textContent=n),this.h()},h(){_(e,"class","button svelte-a6ns41"),_(e,"slot","trigger")},m(a,i){I(a,e,i)},p:G,d(a){a&&g(e)}}}function ct(t){let e,n,a="Add images",i,l,s,u;return{c(){e=w("label"),n=w("div"),n.textContent=a,i=A(),l=w("input"),this.h()},l(r){e=y(r,"LABEL",{class:!0});var o=L(e);n=y(o,"DIV",{class:!0,["data-svelte-h"]:!0}),H(n)!=="svelte-ecwxcw"&&(n.textContent=a),i=R(o),l=y(o,"INPUT",{type:!0,accept:!0,class:!0}),o.forEach(g),this.h()},h(){_(n,"class","button svelte-a6ns41"),_(l,"type","file"),l.multiple=!0,_(l,"accept","image/png, image/jpeg"),_(l,"class","svelte-a6ns41"),_(e,"class","input svelte-a6ns41")},m(r,o){I(r,e,o),E(e,n),E(e,i),E(e,l),s||(u=z(l,"change",t[14]),s=!0)},p:G,d(r){r&&g(e),s=!1,u()}}}function ft(t){let e,n,a,i=x(t[8].items),l=[];for(let s=0;s<i.length;s+=1)l[s]=_e(he(t,i,s));return{c(){e=w("canvas"),n=A(),a=w("div");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=y(s,"CANVAS",{class:!0}),L(e).forEach(g),n=R(s),a=y(s,"DIV",{class:!0,style:!0});var u=L(a);for(let r=0;r<l.length;r+=1)l[r].l(u);u.forEach(g),this.h()},h(){_(e,"class","canvas svelte-a6ns41"),_(a,"class","grid svelte-a6ns41"),N(a,"aspect-ratio",t[8].w/t[8].h)},m(s,u){I(s,e,u),t[26](e),I(s,n,u),I(s,a,u);for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(a,null)},p(s,u){if(u[0]&2304){i=x(s[8].items);let r;for(r=0;r<i.length;r+=1){const o=he(s,i,r);l[r]?l[r].p(o,u):(l[r]=_e(o),l[r].c(),l[r].m(a,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=i.length}u[0]&256&&N(a,"aspect-ratio",s[8].w/s[8].h)},d(s){s&&(g(e),g(n),g(a)),t[26](null),me(l,s)}}}function _e(t){let e,n,a;function i(){return t[27](t[33])}return{c(){e=w("div"),this.h()},l(l){e=y(l,"DIV",{class:!0,style:!0,role:!0}),L(e).forEach(g),this.h()},h(){_(e,"class","grid-item svelte-a6ns41"),N(e,"width",t[31].w/t[8].w*100+"%"),N(e,"height",t[31].h/t[8].h*100+"%"),N(e,"left",t[31].x/t[8].w*100+"%"),N(e,"top",t[31].y/t[8].h*100+"%"),_(e,"role","presentation")},m(l,s){I(l,e,s),n||(a=z(e,"click",i),n=!0)},p(l,s){t=l,s[0]&256&&N(e,"width",t[31].w/t[8].w*100+"%"),s[0]&256&&N(e,"height",t[31].h/t[8].h*100+"%"),s[0]&256&&N(e,"left",t[31].x/t[8].w*100+"%"),s[0]&256&&N(e,"top",t[31].y/t[8].h*100+"%")},d(l){l&&g(e),n=!1,a()}}}function ge(t){let e,n,a="Save",i,l,s="Reset",u,r;return{c(){e=w("div"),n=w("button"),n.textContent=a,i=A(),l=w("button"),l.textContent=s,this.h()},l(o){e=y(o,"DIV",{class:!0});var p=L(e);n=y(p,"BUTTON",{class:!0,["data-svelte-h"]:!0}),H(n)!=="svelte-1ktiavv"&&(n.textContent=a),i=R(p),l=y(p,"BUTTON",{class:!0,["data-svelte-h"]:!0}),H(l)!=="svelte-bt4pce"&&(l.textContent=s),p.forEach(g),this.h()},h(){_(n,"class","button svelte-a6ns41"),_(l,"class","button reset svelte-a6ns41"),_(e,"class","save svelte-a6ns41")},m(o,p){I(o,e,p),E(e,n),E(e,i),E(e,l),u||(r=[z(n,"click",t[13]),z(l,"click",t[15])],u=!0)},p:G,d(o){o&&g(e),u=!1,Ce(r)}}}function pt(t){let e,n,a,i,l,s,u,r,o=t[0].length>0&&de(t);function p(c,m){return c[0].length>0?ft:ct}let f=p(t),d=f(t),h=t[0].length>0&&ge(t);return{c(){o&&o.c(),e=A(),n=w("div"),d.c(),i=A(),h&&h.c(),l=re(),this.h()},l(c){o&&o.l(c),e=R(c),n=y(c,"DIV",{class:!0});var m=L(n);d.l(m),m.forEach(g),i=R(c),h&&h.l(c),l=re(),this.h()},h(){_(n,"class",a="canvasWrapper "+(t[10]?"vertical":"horizontal")+" svelte-a6ns41")},m(c,m){o&&o.m(c,m),I(c,e,m),I(c,n,m),d.m(n,null),t[28](n),I(c,i,m),h&&h.m(c,m),I(c,l,m),s=!0,u||(r=z(window,"resize",t[12]),u=!0)},p(c,m){c[0].length>0?o?(o.p(c,m),m[0]&1&&O(o,1)):(o=de(c),o.c(),O(o,1),o.m(e.parentNode,e)):o&&(ke(),U(o,1,1,()=>{o=null}),Ee()),f===(f=p(c))&&d?d.p(c,m):(d.d(1),d=f(c),d&&(d.c(),d.m(n,null))),(!s||m[0]&1024&&a!==(a="canvasWrapper "+(c[10]?"vertical":"horizontal")+" svelte-a6ns41"))&&_(n,"class",a),c[0].length>0?h?h.p(c,m):(h=ge(c),h.c(),h.m(l.parentNode,l)):h&&(h.d(1),h=null)},i(c){s||(O(o),s=!0)},o(c){U(o),s=!1},d(c){c&&(g(e),g(n),g(i),g(l)),o&&o.d(c),d.d(),t[28](null),h&&h.d(c),u=!1,r()}}}function B(t,e){return localStorage.getItem(t)||e}function q(t,e){localStorage.setItem(t,e)}function ht(t){return t==="auto"?t:Number(t)}function dt(t){const e=t.map(i=>i.width/i.height),n=e.reduce((i,l)=>i+l,0),a=e.map(i=>1/i).reduce((i,l)=>i+l,0);return n<a?"horizontal":"vertical"}function _t(t,e){if(e==="auto")return t;if(console.log({aspectRatio:e}),t.w/t.h>e){const a=t.w/e,i=(a-t.h)/2;t.items.forEach(l=>{l.y+=i}),t.h=a}else{const a=t.h*e,i=(a-t.w)/2;t.items.forEach(l=>{l.x+=i}),t.w=a}return t}function gt(t,e,n){t.canvas.width=e.w,t.canvas.height=e.h,t.fillStyle=n,t.fillRect(0,0,e.w,e.h),e.items.forEach(({image:a,x:i,y:l,w:s,h:u},r)=>{t.drawImage(a,i,l,s,u)})}function mt(t,e,n){let a,i,l,s=[],u=null,r=[];function o(b){if(u!==b)if(u!==null){const P=u,K=b,Ve=s[P],Pe=s[K];n(16,s=s.map((Fe,ae)=>ae===P?Pe:ae===K?Ve:Fe)),u=null}else u=b}let p=B("backgroundColor","#FFFFFF"),f=B("layoutType","horizontal"),d=B("size","m"),h=Number(B("spacing","3")),c=B("aspectRatio","auto"),m=!0,D=null,T=null,v={w:0,h:0};function C(b){if(!b)return;const P=b.getBoundingClientRect();n(18,v.w=P.width,v),n(18,v.h=P.height,v)}function k(){C(T)}function S(b){b.preventDefault(),D&&tt(D,"collage")}function V(b){const P=b.target;P.files&&(n(16,s=s.concat(Array.from(P.files).map(K=>URL.createObjectURL(K)))),P.value="",n(17,m=!0))}function M(){n(16,s=[])}let ee=!1;function Le(b){f=b,n(2,f),n(17,m),n(0,r),n(16,s)}function Ae(b){d=b,n(3,d)}function Re(b){c=b,n(5,c)}function Oe(){p=this.value,n(1,p)}function Te(){h=Ke(this.value),n(4,h)}function ze(b){ee=b,n(9,ee)}function De(b){F[b?"unshift":"push"](()=>{D=b,n(6,D)})}const Ne=b=>o(b);function Ue(b){F[b?"unshift":"push"](()=>{T=b,n(7,T)})}return t.$$.update=()=>{t.$$.dirty[0]&65536&&rt(s).then(b=>{n(0,r=b)}),t.$$.dirty[0]&131073&&m&&r.length>0&&(n(2,f=dt(r)),n(17,m=!1)),t.$$.dirty[0]&62&&(q("backgroundColor",p),q("layoutType",f),q("size",d),q("spacing",h.toString()),q("aspectRatio",c)),t.$$.dirty[0]&61&&n(8,a=_t(it[f](r,{size:d,spacing:h}),ht(c))),t.$$.dirty[0]&64&&n(19,i=D?.getContext("2d")),t.$$.dirty[0]&524547&&i&&r.length&&requestAnimationFrame(()=>{gt(i,a,p)}),t.$$.dirty[0]&262400&&n(10,l=a.w/a.h<v.w/v.h),t.$$.dirty[0]&128&&C(T)},[r,p,f,d,h,c,D,T,a,ee,l,o,k,S,V,M,s,m,v,i,Le,Ae,Re,Oe,Te,ze,De,Ne,Ue]}class wt extends ne{constructor(e){super(),le(this,e,mt,pt,se,{},null,[-1,-1])}}export{wt as default};
