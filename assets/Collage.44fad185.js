import{S as ce,i as fe,s as he,a as N,e as g,F as $,f as U,c as C,b as P,d as b,g as _,j as L,m as T,n as Z,D,G as j,H as ee,k as m,I as Q,r as pe,J as te,K as de,E as le,h as O,l as _e}from"./index.69988667.js";import{e as ne}from"./each.3d878967.js";const H=document.createElement("a");document.body.appendChild(H);H.style.display="none";function ve(e,t){return new Promise(l=>{e.toBlob(a=>{if(a){const c=URL.createObjectURL(a);H.href=c,H.download=`${t}.jpg`,H.click(),URL.revokeObjectURL(c),l(a)}},"image/jpeg")})}const me={s:1e3,m:2e3,l:3e3};function re(e){return me[e]}function ge(e,t){return re(t)*(e/100)}function ue(e,{size:t,spacing:l},a){const i={items:[],w:0,h:0},s=e.map(u=>u.width/u.height),r=re(t),n=ge(l,t),p=s.map(u=>a?[r,Math.round(r/u)]:[Math.round(r*u),r]),k=p.map(([u,o])=>a?o:u).reduce((u,o)=>u+o,n*(e.length+1));a?(i.w=r+n*2,i.h=k):(i.w=k,i.h=r+n*2);let f=n;return e.forEach((u,o)=>{const h=p[o];a?(i.items.push({image:u,x:n,y:f,w:h[0],h:h[1]}),f+=h[1]+n):(i.items.push({image:u,x:f,y:n,w:h[0],h:h[1]}),f+=h[0]+n)}),i}function Ce(e,t){return ue(e,t,!0)}function be(e,t){return ue(e,t,!1)}const we={horizontal:be,vertical:Ce};async function ye(e){return Promise.all(e.map(t=>new Promise(l=>{const a=new Image;a.onload=()=>{l(a)},a.src=t})))}function se(e,t,l){const a=e.slice();return a[26]=t[l],a[28]=l,a}function ie(e){let t,l,a,c="Add images",i,s,r,n,p,k="Small",f,u="Medium",o,h="Large",R,y,E,G="Horizontal",S,J="Vertical",B,I,q,F,M,z,K="Reset",W,d;return{c(){t=g("div"),l=g("label"),a=g("div"),a.textContent=c,i=N(),s=g("input"),r=N(),n=g("select"),p=g("option"),p.textContent=k,f=g("option"),f.textContent=u,o=g("option"),o.textContent=h,R=N(),y=g("select"),E=g("option"),E.textContent=G,S=g("option"),S.textContent=J,B=N(),I=g("input"),q=N(),F=g("input"),M=N(),z=g("button"),z.textContent=K,this.h()},l(w){t=C(w,"DIV",{class:!0});var v=P(t);l=C(v,"LABEL",{class:!0});var A=P(l);a=C(A,"DIV",{class:!0,["data-svelte-h"]:!0}),D(a)!=="svelte-ecwxcw"&&(a.textContent=c),i=U(A),s=C(A,"INPUT",{type:!0,accept:!0,class:!0}),A.forEach(b),r=U(v),n=C(v,"SELECT",{});var V=P(n);p=C(V,"OPTION",{["data-svelte-h"]:!0}),D(p)!=="svelte-cqkaja"&&(p.textContent=k),f=C(V,"OPTION",{["data-svelte-h"]:!0}),D(f)!=="svelte-cdvn1s"&&(f.textContent=u),o=C(V,"OPTION",{["data-svelte-h"]:!0}),D(o)!=="svelte-1ezouf3"&&(o.textContent=h),V.forEach(b),R=U(v),y=C(v,"SELECT",{});var x=P(y);E=C(x,"OPTION",{["data-svelte-h"]:!0}),D(E)!=="svelte-1eqx6rq"&&(E.textContent=G),S=C(x,"OPTION",{["data-svelte-h"]:!0}),D(S)!=="svelte-ahrgri"&&(S.textContent=J),x.forEach(b),B=U(v),I=C(v,"INPUT",{type:!0,min:!0,max:!0,step:!0}),q=U(v),F=C(v,"INPUT",{type:!0}),M=U(v),z=C(v,"BUTTON",{class:!0,["data-svelte-h"]:!0}),D(z)!=="svelte-bt4pce"&&(z.textContent=K),v.forEach(b),this.h()},h(){_(a,"class","button svelte-1x80if5"),_(s,"type","file"),s.multiple=!0,_(s,"accept","image/png, image/jpeg"),_(s,"class","svelte-1x80if5"),_(l,"class","input svelte-1x80if5"),p.__value="s",j(p,p.__value),f.__value="m",j(f,f.__value),o.__value="l",j(o,o.__value),e[4]===void 0&&ee(()=>e[17].call(n)),E.__value="horizontal",j(E,E.__value),S.__value="vertical",j(S,S.__value),e[3]===void 0&&ee(()=>e[18].call(y)),_(I,"type","range"),_(I,"min","0"),_(I,"max","10"),_(I,"step","1"),_(F,"type","color"),_(z,"class","button reset svelte-1x80if5"),_(t,"class","panel svelte-1x80if5")},m(w,v){L(w,t,v),m(t,l),m(l,a),m(l,i),m(l,s),m(t,r),m(t,n),m(n,p),m(n,f),m(n,o),Q(n,e[4],!0),m(t,R),m(t,y),m(y,E),m(y,S),Q(y,e[3],!0),m(t,B),m(t,I),j(I,e[5]),m(t,q),m(t,F),j(F,e[2]),m(t,M),m(t,z),W||(d=[T(s,"change",e[13]),T(n,"change",e[17]),T(y,"change",e[18]),T(I,"change",e[19]),T(I,"input",e[19]),T(F,"input",e[20]),T(z,"click",e[14])],W=!0)},p(w,v){v&16&&Q(n,w[4]),v&8&&Q(y,w[3]),v&32&&j(I,w[5]),v&4&&j(F,w[2])},d(w){w&&b(t),W=!1,pe(d)}}}function ke(e){let t,l,a="Add images",c,i,s,r;return{c(){t=g("label"),l=g("div"),l.textContent=a,c=N(),i=g("input"),this.h()},l(n){t=C(n,"LABEL",{class:!0});var p=P(t);l=C(p,"DIV",{class:!0,["data-svelte-h"]:!0}),D(l)!=="svelte-ecwxcw"&&(l.textContent=a),c=U(p),i=C(p,"INPUT",{type:!0,accept:!0,class:!0}),p.forEach(b),this.h()},h(){_(l,"class","button svelte-1x80if5"),_(i,"type","file"),i.multiple=!0,_(i,"accept","image/png, image/jpeg"),_(i,"class","svelte-1x80if5"),_(t,"class","input svelte-1x80if5")},m(n,p){L(n,t,p),m(t,l),m(t,c),m(t,i),s||(r=T(i,"change",e[13]),s=!0)},p:Z,d(n){n&&b(t),s=!1,r()}}}function Ie(e){let t,l,a,c=ne(e[8].items),i=[];for(let s=0;s<c.length;s+=1)i[s]=ae(se(e,c,s));return{c(){t=g("canvas"),l=N(),a=g("div");for(let s=0;s<i.length;s+=1)i[s].c();this.h()},l(s){t=C(s,"CANVAS",{class:!0}),P(t).forEach(b),l=U(s),a=C(s,"DIV",{class:!0,style:!0});var r=P(a);for(let n=0;n<i.length;n+=1)i[n].l(r);r.forEach(b),this.h()},h(){_(t,"class","canvas svelte-1x80if5"),_(a,"class","grid svelte-1x80if5"),O(a,"aspect-ratio",e[8].w/e[8].h)},m(s,r){L(s,t,r),e[21](t),L(s,l,r),L(s,a,r);for(let n=0;n<i.length;n+=1)i[n]&&i[n].m(a,null)},p(s,r){if(r&1281){c=ne(s[8].items);let n;for(n=0;n<c.length;n+=1){const p=se(s,c,n);i[n]?i[n].p(p,r):(i[n]=ae(p),i[n].c(),i[n].m(a,null))}for(;n<i.length;n+=1)i[n].d(1);i.length=c.length}r&256&&O(a,"aspect-ratio",s[8].w/s[8].h)},d(s){s&&(b(t),b(l),b(a)),e[21](null),_e(i,s)}}}function ae(e){let t,l,a;function c(){return e[22](e[28])}return{c(){t=g("div"),this.h()},l(i){t=C(i,"DIV",{class:!0,style:!0,role:!0}),P(t).forEach(b),this.h()},h(){_(t,"class","grid-item svelte-1x80if5"),O(t,"width",e[26].w/e[8].w*100+"%"),O(t,"height",e[26].h/e[8].h*100+"%"),O(t,"left",e[26].x/e[8].w*100+"%"),O(t,"top",e[26].y/e[8].h*100+"%"),_(t,"role","presentation")},m(i,s){L(i,t,s),l||(a=T(t,"click",c),l=!0)},p(i,s){e=i,s&256&&O(t,"width",e[26].w/e[8].w*100+"%"),s&256&&O(t,"height",e[26].h/e[8].h*100+"%"),s&256&&O(t,"left",e[26].x/e[8].w*100+"%"),s&256&&O(t,"top",e[26].y/e[8].h*100+"%")},d(i){i&&b(t),l=!1,a()}}}function oe(e){let t,l,a="Save",c,i;return{c(){t=g("div"),l=g("button"),l.textContent=a,this.h()},l(s){t=C(s,"DIV",{class:!0});var r=P(t);l=C(r,"BUTTON",{class:!0,["data-svelte-h"]:!0}),D(l)!=="svelte-1ktiavv"&&(l.textContent=a),r.forEach(b),this.h()},h(){_(l,"class","button svelte-1x80if5"),_(t,"class","save svelte-1x80if5")},m(s,r){L(s,t,r),m(t,l),c||(i=T(l,"click",e[12]),c=!0)},p:Z,d(s){s&&b(t),c=!1,i()}}}function Ee(e){let t,l,a,c,i,s,r,n=e[1].length>0&&ie(e);function p(o,h){return o[1].length>0?Ie:ke}let k=p(e),f=k(e),u=e[1].length>0&&oe(e);return{c(){n&&n.c(),t=N(),l=g("div"),f.c(),c=N(),u&&u.c(),i=$(),this.h()},l(o){n&&n.l(o),t=U(o),l=C(o,"DIV",{class:!0});var h=P(l);f.l(h),h.forEach(b),c=U(o),u&&u.l(o),i=$(),this.h()},h(){_(l,"class",a="canvasWrapper "+(e[9]?"vertical":"horizontal")+" svelte-1x80if5")},m(o,h){n&&n.m(o,h),L(o,t,h),L(o,l,h),f.m(l,null),e[23](l),L(o,c,h),u&&u.m(o,h),L(o,i,h),s||(r=T(window,"resize",e[11]),s=!0)},p(o,[h]){o[1].length>0?n?n.p(o,h):(n=ie(o),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null),k===(k=p(o))&&f?f.p(o,h):(f.d(1),f=k(o),f&&(f.c(),f.m(l,null))),h&512&&a!==(a="canvasWrapper "+(o[9]?"vertical":"horizontal")+" svelte-1x80if5")&&_(l,"class",a),o[1].length>0?u?u.p(o,h):(u=oe(o),u.c(),u.m(i.parentNode,i)):u&&(u.d(1),u=null)},i:Z,o:Z,d(o){o&&(b(t),b(l),b(c),b(i)),n&&n.d(o),f.d(),e[23](null),u&&u.d(o),s=!1,r()}}}function X(e,t){return localStorage.getItem(e)||t}function Y(e,t){localStorage.setItem(e,t)}function Se(e,t,l){e.canvas.width=t.w,e.canvas.height=t.h,e.fillStyle=l,e.fillRect(0,0,t.w,t.h),t.items.forEach(({image:a,x:c,y:i,w:s,h:r},n)=>{e.drawImage(a,c,i,s,r)})}function Te(e,t,l){let a,c,i,s=[],r,n=[];function p(d){if(console.log("selectUrl",{selectedUrl:r,url:d}),r===d)r=null;else if(r){const w=s.indexOf(r),v=s.indexOf(d);l(0,s=s.map((A,V)=>V===w?d:V===v?r:A)),r=null}else r=d}let k=X("backgroundColor","#FFFFFF"),f=X("layoutType","horizontal"),u=X("size","m"),o=Number(X("spacing","3")),h=null,R=null,y={w:0,h:0};function E(d){if(!d)return;const w=d.getBoundingClientRect();l(15,y.w=w.width,y),l(15,y.h=w.height,y)}function G(){E(R)}function S(d){d.preventDefault(),h&&ve(h,"collage")}function J(d){const w=d.target;w.files&&(l(0,s=s.concat(Array.from(w.files).map(v=>URL.createObjectURL(v)))),w.value="")}function B(){l(0,s=[])}function I(){u=te(this),l(4,u)}function q(){f=te(this),l(3,f)}function F(){o=de(this.value),l(5,o)}function M(){k=this.value,l(2,k)}function z(d){le[d?"unshift":"push"](()=>{h=d,l(6,h)})}const K=d=>p(s[d]);function W(d){le[d?"unshift":"push"](()=>{R=d,l(7,R)})}return e.$$.update=()=>{e.$$.dirty&1&&ye(s).then(d=>{l(1,n=d)}),e.$$.dirty&60&&(Y("backgroundColor",k),Y("layoutType",f),Y("size",u),Y("spacing",o.toString())),e.$$.dirty&58&&l(8,a=we[f](n,{size:u,spacing:o})),e.$$.dirty&64&&l(16,c=h?.getContext("2d")),e.$$.dirty&65796&&c&&requestAnimationFrame(()=>{Se(c,a,k)}),e.$$.dirty&33024&&l(9,i=a.w/a.h<y.w/y.h),e.$$.dirty&128&&E(R)},[s,n,k,f,u,o,h,R,a,i,p,G,S,J,B,y,c,I,q,F,M,z,K,W]}class Oe extends ce{constructor(t){super(),fe(this,t,Te,Ee,he,{})}}export{Oe as default};
