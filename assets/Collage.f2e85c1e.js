import{S as Se,i as Ee,s as Ce,e as y,c as k,b as z,d as m,g as h,j as L,n as ce,l as Ge,F as yt,a as V,t as X,f as F,p as Z,G as H,k as v,m as N,H as kt,I as It,J as Ye,K as Ke,L as Je,M as Qe,u as G,y as Xe,w as $,v as Ze,o as St,N as Et,O as Ae,E as ae,P as Oe,Q as de,z as _e,D as fe,A as ge,B as me,R as be,C as ve,r as Le,T as re,h as Q}from"./index.a18ea272.js";import{e as we}from"./each.3d878967.js";const Ct="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let Lt=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t|=0));for(;t--;)e+=Ct[n[t]&63];return e};function Ue(t,e,n){const i=t.slice();return i[5]=e[n],i}function Pe(t){let e,n,i,r=!1,s,l,a=t[5].label+"",u,o,p,_,f;return p=yt(t[4][0]),{c(){e=y("label"),n=y("input"),s=V(),l=y("span"),u=X(a),o=V(),this.h()},l(d){e=k(d,"LABEL",{class:!0});var c=z(e);n=k(c,"INPUT",{type:!0,name:!0,class:!0}),s=F(c),l=k(c,"SPAN",{class:!0});var w=z(l);u=Z(w,a),w.forEach(m),o=F(c),c.forEach(m),this.h()},h(){h(n,"type","radio"),h(n,"name",t[2]),n.__value=i=t[5].value,H(n,n.__value),h(n,"class","svelte-939ti0"),h(l,"class","button svelte-939ti0"),h(e,"class","wrapper svelte-939ti0"),p.p(n)},m(d,c){L(d,e,c),v(e,n),n.checked=n.__value===t[0],v(e,s),v(e,l),v(l,u),v(e,o),_||(f=N(n,"change",t[3]),_=!0)},p(d,c){c&2&&i!==(i=d[5].value)&&(n.__value=i,H(n,n.__value),r=!0),(r||c&3)&&(n.checked=n.__value===d[0]),c&2&&a!==(a=d[5].label+"")&&kt(u,a)},d(d){d&&m(e),p.r(),_=!1,f()}}}function Nt(t){let e,n=we(t[1]),i=[];for(let r=0;r<n.length;r+=1)i[r]=Pe(Ue(t,n,r));return{c(){e=y("div");for(let r=0;r<i.length;r+=1)i[r].c();this.h()},l(r){e=k(r,"DIV",{class:!0});var s=z(e);for(let l=0;l<i.length;l+=1)i[l].l(s);s.forEach(m),this.h()},h(){h(e,"class","group svelte-939ti0")},m(r,s){L(r,e,s);for(let l=0;l<i.length;l+=1)i[l]&&i[l].m(e,null)},p(r,[s]){if(s&7){n=we(r[1]);let l;for(l=0;l<n.length;l+=1){const a=Ue(r,n,l);i[l]?i[l].p(a,s):(i[l]=Pe(a),i[l].c(),i[l].m(e,null))}for(;l<i.length;l+=1)i[l].d(1);i.length=n.length}},i:ce,o:ce,d(r){r&&m(e),Ge(i,r)}}}function Tt(t,e,n){const i=Lt();let{options:r=[]}=e,{value:s}=e;const l=[[]];function a(){s=this.__value,n(0,s)}return t.$$set=u=>{"options"in u&&n(1,r=u.options),"value"in u&&n(0,s=u.value)},[s,r,i,a,l]}class Ie extends Se{constructor(e){super(),Ee(this,e,Tt,Nt,Ce,{options:1,value:0})}}function Re(t,{delay:e=0,duration:n=400,easing:i=It}={}){const r=+getComputedStyle(t).opacity;return{delay:e,duration:n,easing:i,css:s=>`opacity: ${s*r}`}}const At=t=>({}),ze=t=>({});function Be(t){let e,n,i;const r=t[5].default,s=Ye(r,t,t[4],null);return{c(){e=y("nav"),s&&s.c(),this.h()},l(l){e=k(l,"NAV",{class:!0,"aria-label":!0});var a=z(e);s&&s.l(a),a.forEach(m),this.h()},h(){h(e,"class","menu svelte-v9qt9l"),h(e,"aria-label",t[1])},m(l,a){L(l,e,a),s&&s.m(e,null),i=!0},p(l,a){s&&s.p&&(!i||a&16)&&Ke(s,r,l,l[4],i?Qe(r,l[4],a,null):Je(l[4]),null),(!i||a&2)&&h(e,"aria-label",l[1])},i(l){i||(G(s,l),l&&Et(()=>{i&&(n||(n=Ae(e,Re,{duration:100},!0)),n.run(1))}),i=!0)},o(l){$(s,l),l&&(n||(n=Ae(e,Re,{duration:100},!1)),n.run(0)),i=!1},d(l){l&&m(e),s&&s.d(l),l&&n&&n.end()}}}function Ot(t){let e,n,i,r,s,l;const a=t[5].trigger,u=Ye(a,t,t[4],ze);let o=t[0]&&Be(t);return{c(){e=y("details"),n=y("summary"),u&&u.c(),i=V(),o&&o.c(),this.h()},l(p){e=k(p,"DETAILS",{class:!0});var _=z(e);n=k(_,"SUMMARY",{class:!0});var f=z(n);u&&u.l(f),f.forEach(m),i=F(_),o&&o.l(_),_.forEach(m),this.h()},h(){h(n,"class","summary svelte-v9qt9l"),h(e,"class","dropdown svelte-v9qt9l")},m(p,_){L(p,e,_),v(e,n),u&&u.m(n,null),v(e,i),o&&o.m(e,null),t[6](e),r=!0,s||(l=N(e,"toggle",t[3]),s=!0)},p(p,[_]){u&&u.p&&(!r||_&16)&&Ke(u,a,p,p[4],r?Qe(a,p[4],_,At):Je(p[4]),ze),p[0]?o?(o.p(p,_),_&1&&G(o,1)):(o=Be(p),o.c(),G(o,1),o.m(e,null)):o&&(Xe(),$(o,1,1,()=>{o=null}),Ze())},i(p){r||(G(u,p),G(o),r=!0)},o(p){$(u,p),$(o),r=!1},d(p){p&&m(e),u&&u.d(p),o&&o.d(),t[6](null),s=!1,l()}}}function Ut(t,e,n){let{$$slots:i={},$$scope:r}=e,{isOpen:s=!1}=e,{label:l="Меню"}=e,a;function u(_){n(0,s=_.target.open)}function o(_){_.key==="Escape"&&s&&(n(0,s=!1),a?.querySelector("summary")?.focus())}St(()=>(document.addEventListener("keydown",o),()=>document.removeEventListener("keydown",o)));function p(_){ae[_?"unshift":"push"](()=>{a=_,n(2,a),n(0,s)})}return t.$$set=_=>{"isOpen"in _&&n(0,s=_.isOpen),"label"in _&&n(1,l=_.label),"$$scope"in _&&n(4,r=_.$$scope)},t.$$.update=()=>{t.$$.dirty&5&&a&&n(2,a.open=s,a)},[s,l,a,u,r,i,p]}class Pt extends Se{constructor(e){super(),Ee(this,e,Ut,Ot,Ce,{isOpen:0,label:1})}}const ue=document.createElement("a");document.body.appendChild(ue);ue.style.display="none";function ke(t,e){return new Promise(n=>{t.toBlob(i=>{if(i){const r=URL.createObjectURL(i);ue.href=r,ue.download=`${e}.jpg`,ue.click(),URL.revokeObjectURL(r),n(i)}},"image/jpeg")})}const Rt={s:1e3,m:2e3,l:3e3};function $e(t){return Rt[t]}function De(t,e){return $e(e)*(t/100)}function xe(t,{size:e,spacing:n,padding:i},r){const l={items:[],w:0,h:0},a=t.map(c=>c.width/c.height),u=$e(e),o=De(n,e),p=De(i,e),_=a.map(c=>r?[u,Math.round(u/c)]:[Math.round(u*c),u]),f=_.map(([c,w])=>r?w:c).reduce((c,w)=>c+w,o*(t.length-1)+p*2);r?(l.w=u+p*2,l.h=f):(l.w=f,l.h=u+p*2);let d=p;return t.forEach((c,w)=>{const O=_[w];r?(l.items.push({image:c,x:p,y:d,w:O[0],h:O[1]}),d+=O[1]+o):(l.items.push({image:c,x:d,y:p,w:O[0],h:O[1]}),d+=O[0]+o)}),l}function zt(t,e){return xe(t,e,!0)}function Bt(t,e){return xe(t,e,!1)}const Dt={horizontal:Bt,vertical:zt};async function Vt(t){return Promise.all(t.map(e=>new Promise(n=>{const i=new Image;i.onload=()=>{n(i)},i.src=e})))}function Ve(t,e,n){const i=t.slice();return i[55]=e[n],i[57]=n,i}function Fe(t){let e,n,i,r="+",s,l,a,u,o,p,_,f,d,c,w;function O(S){t[30](S)}let T={options:[{value:"horizontal",label:"Horizontal"},{value:"vertical",label:"Vertical"}]};t[2]!==void 0&&(T.value=t[2]),u=new Ie({props:T}),ae.push(()=>de(u,"value",O));function Y(S){t[43](S)}let W={$$slots:{trigger:[Mt],default:[Ft]},$$scope:{ctx:t}};return t[17]!==void 0&&(W.isOpen=t[17]),_=new Pt({props:W}),ae.push(()=>de(_,"isOpen",Y)),{c(){e=y("div"),n=y("label"),i=y("div"),i.textContent=r,s=V(),l=y("input"),a=V(),_e(u.$$.fragment),p=V(),_e(_.$$.fragment),this.h()},l(S){e=k(S,"DIV",{class:!0});var C=z(e);n=k(C,"LABEL",{class:!0});var P=z(n);i=k(P,"DIV",{class:!0,["data-svelte-h"]:!0}),fe(i)!=="svelte-evoge6"&&(i.textContent=r),s=F(P),l=k(P,"INPUT",{type:!0,accept:!0,class:!0}),P.forEach(m),a=F(C),ge(u.$$.fragment,C),p=F(C),ge(_.$$.fragment,C),C.forEach(m),this.h()},h(){h(i,"class","button svelte-1a0bcb"),h(l,"type","file"),l.multiple=!0,h(l,"accept","image/png, image/jpeg"),h(l,"class","svelte-1a0bcb"),h(n,"class","input svelte-1a0bcb"),h(e,"class","panel svelte-1a0bcb")},m(S,C){L(S,e,C),v(e,n),v(n,i),v(n,s),v(n,l),v(e,a),me(u,e,null),v(e,p),me(_,e,null),d=!0,c||(w=N(l,"change",t[24]),c=!0)},p(S,C){const P={};!o&&C[0]&4&&(o=!0,P.value=S[2],be(()=>o=!1)),u.$set(P);const j={};C[0]&102394|C[1]&134217728&&(j.$$scope={dirty:C,ctx:S}),!f&&C[0]&131072&&(f=!0,j.isOpen=S[17],be(()=>f=!1)),_.$set(j)},i(S){d||(G(u.$$.fragment,S),G(_.$$.fragment,S),d=!0)},o(S){$(u.$$.fragment,S),$(_.$$.fragment,S),d=!1},d(S){S&&m(e),ve(u),ve(_),c=!1,w()}}}function Me(t){let e,n,i,r,s;return{c(){e=y("label"),n=y("input"),i=X(`
            Cut by 3s`),this.h()},l(l){e=k(l,"LABEL",{});var a=z(e);n=k(a,"INPUT",{type:!0}),i=Z(a,`
            Cut by 3s`),a.forEach(m),this.h()},h(){h(n,"type","checkbox")},m(l,a){L(l,e,a),v(e,n),n.checked=t[15],v(e,i),r||(s=N(n,"change",t[33]),r=!0)},p(l,a){a[0]&32768&&(n.checked=l[15])},d(l){l&&m(e),r=!1,s()}}}function je(t){let e,n,i,r,s;return{c(){e=y("label"),n=y("input"),i=X(`
            Cut by halves`),this.h()},l(l){e=k(l,"LABEL",{});var a=z(e);n=k(a,"INPUT",{type:!0}),i=Z(a,`
            Cut by halves`),a.forEach(m),this.h()},h(){h(n,"type","checkbox")},m(l,a){L(l,e,a),v(e,n),n.checked=t[16],v(e,i),r||(s=N(n,"change",t[34]),r=!0)},p(l,a){a[0]&65536&&(n.checked=l[16])},d(l){l&&m(e),r=!1,s()}}}function He(t){let e,n,i,r,s,l,a,u,o,p,_;return{c(){e=y("label"),n=y("input"),i=X(`
            Noise over image`),r=X(`
          Intensity: `),s=y("input"),l=X(`
          Smoothness: `),a=y("input"),u=X(`
          Size: `),o=y("input"),this.h()},l(f){e=k(f,"LABEL",{});var d=z(e);n=k(d,"INPUT",{type:!0}),i=Z(d,`
            Noise over image`),d.forEach(m),r=Z(f,`
          Intensity: `),s=k(f,"INPUT",{type:!0,class:!0,min:!0,max:!0,step:!0}),l=Z(f,`
          Smoothness: `),a=k(f,"INPUT",{type:!0,class:!0,min:!0,max:!0,step:!0}),u=Z(f,`
          Size: `),o=k(f,"INPUT",{type:!0,class:!0,min:!0,max:!0,step:!0}),this.h()},h(){h(n,"type","checkbox"),h(s,"type","range"),h(s,"class","spacingInput svelte-1a0bcb"),h(s,"min","0"),h(s,"max","1"),h(s,"step","0.05"),h(a,"type","range"),h(a,"class","spacingInput svelte-1a0bcb"),h(a,"min","0"),h(a,"max","3"),h(a,"step","0.5"),h(o,"type","range"),h(o,"class","spacingInput svelte-1a0bcb"),h(o,"min","1"),h(o,"max","5"),h(o,"step","1")},m(f,d){L(f,e,d),v(e,n),n.checked=t[8],v(e,i),L(f,r,d),L(f,s,d),H(s,t[9]),L(f,l,d),L(f,a,d),H(a,t[10]),L(f,u,d),L(f,o,d),H(o,t[11]),p||(_=[N(n,"change",t[39]),N(s,"change",t[40]),N(s,"input",t[40]),N(a,"change",t[41]),N(a,"input",t[41]),N(o,"change",t[42]),N(o,"input",t[42])],p=!0)},p(f,d){d[0]&256&&(n.checked=f[8]),d[0]&512&&H(s,f[9]),d[0]&1024&&H(a,f[10]),d[0]&2048&&H(o,f[11])},d(f){f&&(m(e),m(r),m(s),m(l),m(a),m(u),m(o)),p=!1,Le(_)}}}function Ft(t){let e,n,i,r,s,l,a,u,o,p,_,f,d,c,w,O,T,Y,W,S,C,P;function j(I){t[31](I)}let q={options:[{value:"s",label:"S"},{value:"m",label:"M"},{value:"l",label:"L"}]};t[3]!==void 0&&(q.value=t[3]),n=new Ie({props:q}),ae.push(()=>de(n,"value",j));function ne(I){t[32](I)}let x={options:[{value:"auto",label:"Auto"},{value:(1/1).toString(),label:"1/1"},{value:(3/4).toString(),label:"3/4"},{value:(4/3).toString(),label:"4/3"},{value:(4/5).toString(),label:"4/5"},{value:(5/4).toString(),label:"5/4"},{value:(16/9).toString(),label:"16/9"},{value:(9/16).toString(),label:"9/16"},{value:t[21],label:"8/5"},{value:t[20],label:"12/5"}]};t[6]!==void 0&&(x.value=t[6]),s=new Ie({props:x}),ae.push(()=>de(s,"value",ne));let A=t[6]===t[20]&&Me(t),U=t[6]===t[21]&&je(t),B=t[7]&&He(t);return{c(){e=y("div"),_e(n.$$.fragment),r=V(),_e(s.$$.fragment),a=V(),A&&A.c(),u=V(),U&&U.c(),o=V(),p=y("input"),_=X(`

          Spacing: `),f=y("input"),d=X(`
          Padding: `),c=y("input"),w=V(),O=y("label"),T=y("input"),Y=X(`
          Noise`),W=V(),B&&B.c(),this.h()},l(I){e=k(I,"DIV",{class:!0});var E=z(e);ge(n.$$.fragment,E),r=F(E),ge(s.$$.fragment,E),a=F(E),A&&A.l(E),u=F(E),U&&U.l(E),o=F(E),p=k(E,"INPUT",{type:!0}),_=Z(E,`

          Spacing: `),f=k(E,"INPUT",{type:!0,class:!0,min:!0,max:!0,step:!0}),d=Z(E,`
          Padding: `),c=k(E,"INPUT",{type:!0,class:!0,min:!0,max:!0,step:!0}),w=F(E),O=k(E,"LABEL",{});var R=z(O);T=k(R,"INPUT",{type:!0}),Y=Z(R,`
          Noise`),R.forEach(m),W=F(E),B&&B.l(E),E.forEach(m),this.h()},h(){h(p,"type","color"),h(f,"type","range"),h(f,"class","spacingInput svelte-1a0bcb"),h(f,"min","0"),h(f,"max","10"),h(f,"step","1"),h(c,"type","range"),h(c,"class","spacingInput svelte-1a0bcb"),h(c,"min","0"),h(c,"max","10"),h(c,"step","1"),h(T,"type","checkbox"),h(e,"class","settingsMenu svelte-1a0bcb")},m(I,E){L(I,e,E),me(n,e,null),v(e,r),me(s,e,null),v(e,a),A&&A.m(e,null),v(e,u),U&&U.m(e,null),v(e,o),v(e,p),H(p,t[1]),v(e,_),v(e,f),H(f,t[4]),v(e,d),v(e,c),H(c,t[5]),v(e,w),v(e,O),v(O,T),T.checked=t[7],v(O,Y),v(e,W),B&&B.m(e,null),S=!0,C||(P=[N(p,"input",t[35]),N(f,"change",t[36]),N(f,"input",t[36]),N(c,"change",t[37]),N(c,"input",t[37]),N(T,"change",t[38])],C=!0)},p(I,E){const R={};!i&&E[0]&8&&(i=!0,R.value=I[3],be(()=>i=!1)),n.$set(R);const ee={};!l&&E[0]&64&&(l=!0,ee.value=I[6],be(()=>l=!1)),s.$set(ee),I[6]===I[20]?A?A.p(I,E):(A=Me(I),A.c(),A.m(e,u)):A&&(A.d(1),A=null),I[6]===I[21]?U?U.p(I,E):(U=je(I),U.c(),U.m(e,o)):U&&(U.d(1),U=null),E[0]&2&&H(p,I[1]),E[0]&16&&H(f,I[4]),E[0]&32&&H(c,I[5]),E[0]&128&&(T.checked=I[7]),I[7]?B?B.p(I,E):(B=He(I),B.c(),B.m(e,null)):B&&(B.d(1),B=null)},i(I){S||(G(n.$$.fragment,I),G(s.$$.fragment,I),S=!0)},o(I){$(n.$$.fragment,I),$(s.$$.fragment,I),S=!1},d(I){I&&m(e),ve(n),ve(s),A&&A.d(),U&&U.d(),B&&B.d(),C=!1,Le(P)}}}function Mt(t){let e,n="Settings";return{c(){e=y("div"),e.textContent=n,this.h()},l(i){e=k(i,"DIV",{class:!0,slot:!0,["data-svelte-h"]:!0}),fe(e)!=="svelte-jbxl7d"&&(e.textContent=n),this.h()},h(){h(e,"class","button svelte-1a0bcb"),h(e,"slot","trigger")},m(i,r){L(i,e,r)},p:ce,d(i){i&&m(e)}}}function jt(t){let e,n,i="Add images",r,s,l,a;return{c(){e=y("label"),n=y("div"),n.textContent=i,r=V(),s=y("input"),this.h()},l(u){e=k(u,"LABEL",{class:!0});var o=z(e);n=k(o,"DIV",{class:!0,["data-svelte-h"]:!0}),fe(n)!=="svelte-ecwxcw"&&(n.textContent=i),r=F(o),s=k(o,"INPUT",{type:!0,accept:!0,class:!0}),o.forEach(m),this.h()},h(){h(n,"class","button svelte-1a0bcb"),h(s,"type","file"),s.multiple=!0,h(s,"accept","image/png, image/jpeg"),h(s,"class","svelte-1a0bcb"),h(e,"class","input svelte-1a0bcb")},m(u,o){L(u,e,o),v(e,n),v(e,r),v(e,s),l||(a=N(s,"change",t[24]),l=!0)},p:ce,d(u){u&&m(e),l=!1,a()}}}function Ht(t){let e,n,i,r,s=we(t[14].items),l=[];for(let a=0;a<s.length;a+=1)l[a]=qe(Ve(t,s,a));return{c(){e=y("canvas"),n=V(),i=y("div");for(let a=0;a<l.length;a+=1)l[a].c();this.h()},l(a){e=k(a,"CANVAS",{class:!0}),z(e).forEach(m),n=F(a),i=k(a,"DIV",{class:!0,style:!0});var u=z(i);for(let o=0;o<l.length;o+=1)l[o].l(u);u.forEach(m),this.h()},h(){h(e,"class","canvas svelte-1a0bcb"),h(i,"class",r="grid "+(t[15]?"cutByThirds":"")+" "+(t[16]?"cutByHalves":"")+" svelte-1a0bcb"),Q(i,"aspect-ratio",t[14].w/t[14].h)},m(a,u){L(a,e,u),t[44](e),L(a,n,u),L(a,i,u);for(let o=0;o<l.length;o+=1)l[o]&&l[o].m(i,null)},p(a,u){if(u[0]&540672){s=we(a[14].items);let o;for(o=0;o<s.length;o+=1){const p=Ve(a,s,o);l[o]?l[o].p(p,u):(l[o]=qe(p),l[o].c(),l[o].m(i,null))}for(;o<l.length;o+=1)l[o].d(1);l.length=s.length}u[0]&98304&&r!==(r="grid "+(a[15]?"cutByThirds":"")+" "+(a[16]?"cutByHalves":"")+" svelte-1a0bcb")&&h(i,"class",r),u[0]&16384&&Q(i,"aspect-ratio",a[14].w/a[14].h)},d(a){a&&(m(e),m(n),m(i)),t[44](null),Ge(l,a)}}}function qe(t){let e,n,i;function r(){return t[45](t[57])}return{c(){e=y("div"),this.h()},l(s){e=k(s,"DIV",{class:!0,style:!0,role:!0}),z(e).forEach(m),this.h()},h(){h(e,"class","grid-item svelte-1a0bcb"),Q(e,"width",t[55].w/t[14].w*100+"%"),Q(e,"height",t[55].h/t[14].h*100+"%"),Q(e,"left",t[55].x/t[14].w*100+"%"),Q(e,"top",t[55].y/t[14].h*100+"%"),h(e,"role","presentation")},m(s,l){L(s,e,l),n||(i=N(e,"click",r),n=!0)},p(s,l){t=s,l[0]&16384&&Q(e,"width",t[55].w/t[14].w*100+"%"),l[0]&16384&&Q(e,"height",t[55].h/t[14].h*100+"%"),l[0]&16384&&Q(e,"left",t[55].x/t[14].w*100+"%"),l[0]&16384&&Q(e,"top",t[55].y/t[14].h*100+"%")},d(s){s&&m(e),n=!1,i()}}}function We(t){let e,n,i="Save",r,s,l="Reset",a,u;return{c(){e=y("div"),n=y("button"),n.textContent=i,r=V(),s=y("button"),s.textContent=l,this.h()},l(o){e=k(o,"DIV",{class:!0});var p=z(e);n=k(p,"BUTTON",{class:!0,["data-svelte-h"]:!0}),fe(n)!=="svelte-1ktiavv"&&(n.textContent=i),r=F(p),s=k(p,"BUTTON",{class:!0,["data-svelte-h"]:!0}),fe(s)!=="svelte-bt4pce"&&(s.textContent=l),p.forEach(m),this.h()},h(){h(n,"class","button svelte-1a0bcb"),h(s,"class","button reset svelte-1a0bcb"),h(e,"class","save svelte-1a0bcb")},m(o,p){L(o,e,p),v(e,n),v(e,r),v(e,s),a||(u=[N(n,"click",t[23]),N(s,"click",t[25])],a=!0)},p:ce,d(o){o&&m(e),a=!1,Le(u)}}}function qt(t){let e,n,i,r,s,l,a,u,o=t[0].length>0&&Fe(t);function p(c,w){return c[0].length>0?Ht:jt}let _=p(t),f=_(t),d=t[0].length>0&&We(t);return{c(){o&&o.c(),e=V(),n=y("div"),f.c(),r=V(),d&&d.c(),s=Oe(),this.h()},l(c){o&&o.l(c),e=F(c),n=k(c,"DIV",{class:!0});var w=z(n);f.l(w),w.forEach(m),r=F(c),d&&d.l(c),s=Oe(),this.h()},h(){h(n,"class",i="canvasWrapper "+(t[18]?"vertical":"horizontal")+" svelte-1a0bcb")},m(c,w){o&&o.m(c,w),L(c,e,w),L(c,n,w),f.m(n,null),t[46](n),L(c,r,w),d&&d.m(c,w),L(c,s,w),l=!0,a||(u=N(window,"resize",t[22]),a=!0)},p(c,w){c[0].length>0?o?(o.p(c,w),w[0]&1&&G(o,1)):(o=Fe(c),o.c(),G(o,1),o.m(e.parentNode,e)):o&&(Xe(),$(o,1,1,()=>{o=null}),Ze()),_===(_=p(c))&&f?f.p(c,w):(f.d(1),f=_(c),f&&(f.c(),f.m(n,null))),(!l||w[0]&262144&&i!==(i="canvasWrapper "+(c[18]?"vertical":"horizontal")+" svelte-1a0bcb"))&&h(n,"class",i),c[0].length>0?d?d.p(c,w):(d=We(c),d.c(),d.m(s.parentNode,s)):d&&(d.d(1),d=null)},i(c){l||(G(o),l=!0)},o(c){$(o),l=!1},d(c){c&&(m(e),m(n),m(r),m(s)),o&&o.d(c),f.d(),t[46](null),d&&d.d(c),a=!1,u()}}}function K(t,e){return localStorage.getItem(t)||e}function J(t,e){localStorage.setItem(t,e)}function Wt(t){return t==="auto"?t:Number(t)}function Gt(t){const e=t.map(r=>r.width/r.height),n=e.reduce((r,s)=>r+s,0),i=e.map(r=>1/r).reduce((r,s)=>r+s,0);return n<i?"horizontal":"vertical"}function Yt(t,e){if(e==="auto")return t;if(t.w/t.h>e){const i=t.w/e,r=(i-t.h)/2;t.items.forEach(s=>{s.y+=r}),t.h=i}else{const i=t.h*e,r=(i-t.w)/2;t.items.forEach(s=>{s.x+=r}),t.w=i}return t}function Kt(t,e,n){let i,r,s,l=[],a=null,u=[];function o(g){if(a!==g)if(a!==null){const b=a,M=g,D=l[b],se=l[M];n(26,l=l.map((ie,te)=>te===b?se:te===M?D:ie)),a=null}else a=g}const p=(12/5).toString(),_=(8/5).toString();let f=K("backgroundColor","#FFFFFF"),d=K("layoutType","horizontal"),c=K("size","m"),w=Number(K("spacing","3")),O=Number(K("padding","3")),T=K("aspectRatio","auto"),Y=T===p,W=T===_,S=K("noise","false")==="true",C=K("noiseOverImage","false")==="true",P=Number(K("noiseIntensity","0.2")),j=Number(K("noiseSmoothness","0")),q=Number(K("noiseSize","1")),ne=!0;const x=document.createElement("canvas"),A=x.getContext("2d");let U=!0;function B(g,b){if(!A)return;x.width=g,x.height=b;const M=A.createImageData(g,b),D=M.data;for(let se=0;se<b;se+=q)for(let ie=0;ie<g;ie+=q){const te=Math.floor((Math.random()-.5)*255*P);for(let oe=0;oe<q;oe++)for(let he=0;he<q;he++){const Te=ie+he+(se+oe)*g;if(Te>=g*b)continue;const pe=Te*4;D[pe+0]=te+128,D[pe+1]=te+128,D[pe+2]=te+128,D[pe+3]=255*P}}A.putImageData(M,0,0),j>0&&(A.filter=`blur(${j}px)`,A.drawImage(x,0,0))}function I(g){U&&(B(g.canvas.width,g.canvas.height),U=!1),g.globalCompositeOperation="hard-light",g.drawImage(x,0,0),g.globalCompositeOperation="source-over",g.globalAlpha=.2,g.drawImage(x,0,0),g.globalAlpha=1}function E(g,b,M){g.canvas.width=b.w,g.canvas.height=b.h,g.fillStyle=M,g.fillRect(0,0,b.w,b.h),S&&!C&&I(g),b.items.forEach(({image:D,x:se,y:ie,w:te,h:oe},he)=>{g.drawImage(D,se,ie,te,oe)}),S&&C&&I(g)}let R=null,ee=null,le={w:0,h:0};function Ne(g){if(!g)return;const b=g.getBoundingClientRect();n(28,le.w=b.width,le),n(28,le.h=b.height,le)}function et(){Ne(ee)}async function tt(g){if(g.preventDefault(),R)if(Y){const b=document.createElement("canvas"),M=b.getContext("2d");if(!M)return;b.height=R.height,b.width=R.width/3;for(let D=0;D<3;D+=1)M.drawImage(R,b.width*D,0,b.width,b.height,0,0,b.width,b.height),await ke(b,"collage-thirds-"+(D+1))}else if(W){const b=document.createElement("canvas"),M=b.getContext("2d");if(!M)return;b.height=R.height,b.width=R.width/2;for(let D=0;D<2;D+=1)M.drawImage(R,b.width*D,0,b.width,b.height,0,0,b.width,b.height),await ke(b,"collage-havles-"+(D+1))}else await ke(R,"collage")}function nt(g){const b=g.target;b.files&&(n(26,l=l.concat(Array.from(b.files).map(M=>URL.createObjectURL(M)))),b.value="",n(27,ne=!0))}function lt(){n(26,l=[])}let ye=!1;function st(g){d=g,n(2,d),n(27,ne),n(0,u),n(26,l)}function it(g){c=g,n(3,c)}function at(g){T=g,n(6,T)}function ot(){Y=this.checked,n(15,Y),n(6,T)}function rt(){W=this.checked,n(16,W),n(6,T)}function ut(){f=this.value,n(1,f)}function ct(){w=re(this.value),n(4,w)}function ft(){O=re(this.value),n(5,O)}function ht(){S=this.checked,n(7,S)}function pt(){C=this.checked,n(8,C)}function dt(){P=re(this.value),n(9,P)}function _t(){j=re(this.value),n(10,j)}function gt(){q=re(this.value),n(11,q)}function mt(g){ye=g,n(17,ye)}function bt(g){ae[g?"unshift":"push"](()=>{R=g,n(12,R)})}const vt=g=>o(g);function wt(g){ae[g?"unshift":"push"](()=>{ee=g,n(13,ee)})}return t.$$.update=()=>{t.$$.dirty[0]&67108864&&Vt(l).then(g=>{n(0,u=g)}),t.$$.dirty[0]&134217729&&ne&&u.length>0&&(n(2,d=Gt(u)),n(27,ne=!1)),t.$$.dirty[0]&4094&&(J("backgroundColor",f),J("layoutType",d),J("size",c),J("spacing",w.toString()),J("padding",O.toString()),J("aspectRatio",T),J("noise",S?"true":"false"),J("noiseOverImage",C?"true":"false"),J("noiseIntensity",P.toString()),J("noiseSmoothness",j.toString()),J("noiseSize",q.toString())),t.$$.dirty[0]&64&&(T!==p&&n(15,Y=!1),T!==_&&n(16,W=!1)),t.$$.dirty[0]&125&&n(14,i=Yt(Dt[d](u,{size:c,spacing:w,padding:O}),Wt(T))),t.$$.dirty[0]&16384&&i.w&&(U=!0),t.$$.dirty[0]&4096&&n(29,r=R?.getContext("2d")),t.$$.dirty[0]&536891267&&(console.log(S,C,P,j,q),r&&u.length&&requestAnimationFrame(()=>{E(r,i,f)})),t.$$.dirty[0]&3584&&(console.log(P,j,q),U=!0),t.$$.dirty[0]&268451840&&n(18,s=i.w/i.h<le.w/le.h),t.$$.dirty[0]&8192&&Ne(ee)},[u,f,d,c,w,O,T,S,C,P,j,q,R,ee,i,Y,W,ye,s,o,p,_,et,tt,nt,lt,l,ne,le,r,st,it,at,ot,rt,ut,ct,ft,ht,pt,dt,_t,gt,mt,bt,vt,wt]}class Xt extends Se{constructor(e){super(),Ee(this,e,Kt,qt,Ce,{},null,[-1,-1])}}export{Xt as default};
